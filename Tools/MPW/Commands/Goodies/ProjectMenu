##	File:		ProjectMenu##	Contains:	xxx put contents here xxx##	Written by:	Brian Topping##	Copyright:	© 1994 by Catapult Entertainment, Inc., all rights reserved.##	Change History (most recent first):##		 <6>	 7/18/94	ADS		Fixed leftover poo#		 <5>	 7/17/94	dwh		Add ListMRO.#		 <4>	  7/9/94	HEC		Added menu commands to list checked out files and orphansed#									files.#		 <3>	 5/28/94	BET		Add FUD.#		 <2>	 5/28/94	BET		Add 'update active to latest'##	To Do:### Build the Project Menu#Set Exit 0Set ProjMenuName πDeleteMenu {ProjMenuName} ≥ Dev:Null > Dev:NullAlias HeadersOn "∂	AddMenu {ProjMenuName} 'Use Headers!' HeadersOff ;∂	Set ProjectHeaders 1"Alias HeadersOff "∂	AddMenu {ProjMenuName} 'Use Headers' HeadersOn ;∂	Set ProjectHeaders 0"AddMenu {ProjMenuName} 'Add Header to {Active}' 'AddChange "{Active}"'# by default, we want to add headersHeadersOnAddMenu {ProjMenuName} (- ''AddMenu {ProjMenuName} 'Set Project…/π' 'Execute SetProjector'AddMenu {ProjMenuName} 'Mount Project…/µ' 'Execute MountProjector'AddMenu {ProjMenuName} 'Unmount Project…' 'Execute UnmountProjector'AddMenu {ProjMenuName} '(-' ''AddMenu {ProjMenuName} 'Check {Active} Out/J' 'CheckWindowOut "{Active}"'AddMenu {ProjMenuName} 'Check {Active} In/I' 'CheckWindowIn "{Active}" && Close -c "{Active}"'AddMenu {ProjMenuName} 'ModifyReadOnly {Active}' 'ModifyReadOnly "{Active}"'AddMenu {ProjMenuName} 'Cancel {Active}' 'CancelWindowCheckOut "{Active}" && Close -c "{Active}"'AddMenu {ProjMenuName} 'Update Active To Latest'											∂			'Begin;																			∂				Set Exit 0;																	∂				Set ActiveName "{Active}";													∂				If "`projectinfo "{Active}"`" =~ /≈Project:[ ∂t]+([¬ ∂t]+)®1≈/;				∂					If "`mountproject -pp -r`" =~ /≈{®1}≈/;									∂						If "`projectinfo -s "{ActiveName}"`" =~ /≈∂*≈/ ;					∂							Orphanfiles "{ActiveName}";										∂						End;																∂						If "{LockUncheckedOutFiles}" ;										∂							SetFile "{ActiveName}" -a l ;									∂							Close "{ActiveName}" ;											∂							Open "{ActiveName}" ;											∂						End	;																∂						CheckOut -y -open -project {®1} "{ActiveName}";						∂						If "{LockUncheckedOutFiles}" ;										∂							SetFile "{ActiveName}" -a L ;									∂							Close "{ActiveName}" ;											∂							Open "{ActiveName}" ;											∂						End;																∂					Else;																	∂						Alert "Cannot update this file.∂nProject “{®1}” is not mounted."; 	∂					End;																	∂				Else;																		∂					Alert "Cannot update this file.∂nUnable to obtain project information.";∂				End;																		∂			End ∑∑ "{Worksheet}"'AddMenu {ProjMenuName} 'Compare Active With File' 														∂			'Set Exit 0; Set CompareFile "`getfilename -q -m "Compare with which file?"; 	∂			Set RequestStatus {Status}`""" ; If !{RequestStatus};							∂			"{BBSCmds}CompareFiles" {myMonitorType} "{Active}" "{CompareFile}" ∑∑ "{WorkSheet}"; End'AddMenu {ProjMenuName} 'Compare Active With Revision' '"{BBSCmds}CompareRevisions" "{Active}" ∑∑ "{WorkSheet}"'AddMenu {ProjMenuName} "(-" ""AddMenu {ProjMenuName} 'Compare {Active}' 'CompareRevisions "{Active}" ∑∑ "{WorkSheet}"'AddMenu {ProjMenuName} 'Merge {Active}' 'MergeBranch "{Active}" ∑∑ "{WorkSheet}"'AddMenu {ProjMenuName} (- ''AddMenu {ProjMenuName} 'Check Out…' 'CheckOut -w ≥≥ "{WorkSheet}"'AddMenu {ProjMenuName} 'Check In…' 'CheckIn -w ≥≥ "{WorkSheet}"'AddMenu {ProjMenuName} 'New Project…' 'NewProject -w ≥≥ "{WorkSheet}"'AddMenu {ProjMenuName} (- ''AddMenu {ProjMenuName} 'Check Out Newer' 'CheckOut -r -update'AddMenu {ProjMenuName} 'Check In All Files' 'CheckinAll'AddMenu {ProjMenuName} 'Open Checked-Out Files' 'OpenCheckedOut'AddMenu {ProjMenuName} 'List Checked-Out Files' 'ListCheckedOutFiles'AddMenu {ProjMenuName} 'List Orphaned Files' 'ListOrphanedFiles'AddMenu {ProjMenuName} 'List MRO Files' 'ListMRO "{WebTVDir} ≥≥ "{WorkSheet}'Export ProjectHeadersSet Exit 1